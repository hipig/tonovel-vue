<template>
  <div class="max-w-5xl mx-auto px-2 sm:px-6 lg:px-8 mt-8">
    <search-input></search-input>
    <div class="mt-8">
      <div class="text-gray-500 mb-2">关键词为 “{{keyword}}” 的搜索小说结果：</div>
      <div class="flex flex-col">
        <div class="shadow-md rounded-md p-6 flex items-center bg-white mb-6">
          <div class="flex-1">
            <div class="flex items-center">
              <a href="/detail" class="text-2xl text-gray-900">伏天氏</a>
              <div class="inline-flex ml-4">
                <span class="border rounded-md px-2 leading-6 text-sm bg-gray-200">玄幻小说</span>
              </div>
            </div>
            <div class="text-gray-500 pt-1">最新章节：<a href="#" class="text-gray-700 hover:text-gray-800">第1713章 推迟</a></div>
            <div class="text-gray-500 pt-1">作者：<span>净无痕</span></div>
            <div class="text-gray-500 pt-1">来源：<a href="#" target="_blank">https://www.jupindai.com/book/87.html</a></div>
          </div>
          <a href="#" class="h-32 border rounded p-1">
            <img class="h-full" src="https://www.jupindai.com/files/article/image/0/87/87s.jpg" alt="">
          </a>
        </div>
        <div class="shadow-md rounded-md p-6 flex items-center bg-white mb-6">
          <div class="flex-1">
            <div class="flex items-center">
              <a href="#" class="text-2xl text-gray-900">元尊</a>
              <div class="inline-flex ml-4">
                <span class="border rounded-md px-2 leading-6 text-sm bg-gray-200">玄幻小说</span>
              </div>
            </div>
            <div class="text-gray-500 pt-1">最新章节：<a href="#" class="text-gray-700 hover:text-gray-800">第一千一百七十二章 秘法之王</a></div>
            <div class="text-gray-500 pt-1">作者：<span>天蚕土豆</span></div>
            <div class="text-gray-500 pt-1">来源：<a href="#" target="_blank">https://www.jupindai.com/book/101.html</a></div>
          </div>
          <a href="#" class="h-32 border rounded p-1">
            <img class="h-full" src="https://www.jupindai.com/files/article/image/0/101/101s.jpg" alt="">
          </a>
        </div>
        <div class="shadow-md rounded-md p-6 flex items-center bg-white mb-6">
          <div class="flex-1">
            <div class="flex items-center">
              <a href="#" class="text-2xl text-gray-900">伏天氏</a>
              <div class="inline-flex ml-4">
                <span class="border rounded-md px-2 leading-6 text-sm bg-gray-200">玄幻小说</span>
              </div>
            </div>
            <div class="text-gray-500 pt-1">最新章节：<a href="#" class="text-gray-700 hover:text-gray-800">第1713章 推迟</a></div>
            <div class="text-gray-500 pt-1">作者：<span>净无痕</span></div>
            <div class="text-gray-500 pt-1">来源：<a href="#" target="_blank">https://www.jupindai.com/book/87.html</a></div>
          </div>
          <a href="#" class="h-32 border rounded p-1">
            <img class="h-full" src="https://www.jupindai.com/files/article/image/0/87/87s.jpg" alt="">
          </a>
        </div>
        <div class="shadow-md rounded-md p-6 flex items-center bg-white mb-6">
          <div class="flex-1">
            <div class="flex items-center">
              <a href="#" class="text-2xl text-gray-900">元尊</a>
              <div class="inline-flex ml-4">
                <span class="border rounded-md px-2 leading-6 text-sm bg-gray-200">玄幻小说</span>
              </div>
            </div>
            <div class="text-gray-500 pt-1">最新章节：<a href="#" class="text-gray-700 hover:text-gray-800">第一千一百七十二章 秘法之王</a></div>
            <div class="text-gray-500 pt-1">作者：<span>天蚕土豆</span></div>
            <div class="text-gray-500 pt-1">来源：<a href="#" target="_blank">https://www.jupindai.com/book/101.html</a></div>
          </div>
          <a href="#" class="h-32 border rounded p-1">
            <img class="h-full" src="https://www.jupindai.com/files/article/image/0/101/101s.jpg" alt="">
          </a>
        </div>
        <div class="shadow-md rounded-md p-6 flex items-center bg-white mb-6">
          <div class="flex-1">
            <div class="flex items-center">
              <a href="#" class="text-2xl text-gray-900">伏天氏</a>
              <div class="inline-flex ml-4">
                <span class="border rounded-md px-2 leading-6 text-sm bg-gray-200">玄幻小说</span>
              </div>
            </div>
            <div class="text-gray-500 pt-1">最新章节：<a href="#" class="text-gray-700 hover:text-gray-800">第1713章 推迟</a></div>
            <div class="text-gray-500 pt-1">作者：<span>净无痕</span></div>
            <div class="text-gray-500 pt-1">来源：<a href="#" target="_blank">https://www.jupindai.com/book/87.html</a></div>
          </div>
          <a href="#" class="h-32 border rounded p-1">
            <img class="h-full" src="https://www.jupindai.com/files/article/image/0/87/87s.jpg" alt="">
          </a>
        </div>
        <div class="shadow-md rounded-md p-6 flex items-center bg-white mb-6">
          <div class="flex-1">
            <div class="flex items-center">
              <a href="#" class="text-2xl text-gray-900">元尊</a>
              <div class="inline-flex ml-4">
                <span class="border rounded-md px-2 leading-6 text-sm bg-gray-200">玄幻小说</span>
              </div>
            </div>
            <div class="text-gray-500 pt-1">最新章节：<a href="#" class="text-gray-700 hover:text-gray-800">第一千一百七十二章 秘法之王</a></div>
            <div class="text-gray-500 pt-1">作者：<span>天蚕土豆</span></div>
            <div class="text-gray-500 pt-1">来源：<a href="#" target="_blank">https://www.jupindai.com/book/101.html</a></div>
          </div>
          <a href="#" class="h-32 border rounded p-1">
            <img class="h-full" src="https://www.jupindai.com/files/article/image/0/101/101s.jpg" alt="">
          </a>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import SearchInput from '@/components/SearchInput'

export default {
  components: {
    SearchInput
  },
  data () {
    return {
      keyword: ""
    }
  },
  beforeRouteEnter(to, from, next) {
    next(vm => {
      // 确认渲染该组件的对应路由时，获取搜索结果
      vm.getListByKeyword(to.query.q)
    })
  },
  // 当前路由改变，该组件被复用时，获取搜索结果
  beforeRouteUpdate(to, from, next) {
    this.getListByKeyword(to.query.q)
    next()
  },
  // 离开该组件的对应路由时，清空搜索值
  beforeRouteLeave(to, from, next) {
    this.$store.dispatch('search/clearValue')
    next()
  },
  methods: {
    // 使用关键字 keyword 获取搜索结果
    getListByKeyword(keyword) {
      if (keyword) {
        this.keyword = keyword
        // 需要提交事件类型，以更新搜索框的值
        this.$store.dispatch('search/updateValue', keyword)
      }
    }
  }
}
</script>

<style>

</style>
